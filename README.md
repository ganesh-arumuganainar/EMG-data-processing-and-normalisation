# EMG-data-processing-and-normalisation
The collected raw EMG data are processed and normalised to %MVIC values using Python signal processing tools. 

## Processing Steps
We can apply 3 processing with the EMG signal. Specifically, we will (1) remove the mean value from the signal, (2) filter the signal and (3) rectify the signal. 

Create high and low pass filter settings. A ‘high pass’ filter lets frequencies above that cut-off value pass through, while a ‘low pass’ filter lets frequencies below that cut-off value pass through. Raw surface EMG typically has a frequency content of between 6-500 Hz, with the greatest spectral power between 20-150 Hz. Slow oscillations in the EMG signal are likely due to movement artefacts and fast oscillations are often due to unwanted electrical noise. We can apply a digital filter to let high frequency values above 20 Hz pass through (ie. high pass) and let values below 450 Hz pass through (low pass). The sp.signal.butter command requires values between 0 and 1, so filter frequencies are normalised to the Nyquist frequency, which is half of the sampling rate (note: the sampling rate is sometimes called the Nyquist rate, not to be confused with the Nyquist frequency).

EMG signals should always be recorded with analog band-pass filters, often with similar cut-off frequencies (20-450Hz). Between the analog and digital filters, the analog filter is the important one because it acts as an anti-aliasing filter. This means the filter prevents aliasing (distortion) by a higher frequency, non-EMG signal from being recorded. If an EMG signal is aliased and sampled by the analog-to-digital converter, there is no way get rid of this unwanted noise from the signal. Once the EMG signal is analog bandpass filtered and acquired, many researchers choose to not digitally bandpass filter the EMG signal again in Python or Matlab.

Create filter. The scipy butter function is used to design an Nth order Butterworth filter and return the filter coefficients in (B,A) form. So, we specify we want to create a 4th order bandpass filter ([high, low], btype='bandpass'). The order of a filter refers to how well the filter includes wanted frequencies and excludes unwanted frequencies. 4th order Butterworth filters are quite common; the filter order relates to how well the filter attenuates unwanted frequencies outside the selected cut-off frequency. In this line, we create the filter and store filter coefficients in variables b and a.

Filter the EMG signal to smooth it. The scipy filtfilt function is used to apply a linear filter to the signal one time forward, one time backwards. Applying a filter to a signal causes a frequency-dependent phase shift. While this phase shift is unavoidable when applying an analog (ie. hardware) filter, the phase shift can be corrected by applying the digital filter backwards.
